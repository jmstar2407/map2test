<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP - Eleva tu búsqueda</title>
    <link rel="shortcut icon" href="./img/logo4.svg">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="./css/stylesup.css" />
    <link rel="stylesheet" href="./css/stylefilter.css" />
    <link rel="stylesheet" href="./css/stylesmodal.css" />
    <link rel="stylesheet" href="./css/stylesmenu.css" />
</head>


<body>
    <!-- <div class="loader">
        <img src="./img/logo2.png" alt="Logo de carga">
        <img src="./img/logonombre1.png" alt="Logo de carga"
            style="margin-top: -45px; animation: loadernombre 5s forwards; ">
    </div> -->

    <div class="boxmaster">
        

        <div class="menumaster">
            <!-- Menu Left -->
            <div class="menumaster-in-left">
                <!-- <div class="logoicon"><img src="./img/logo2.png"></div> -->
                <div class="logonombre">
                    <div class="logo1"></div>
                    <!-- <h1>Arríba<span>Te</span></h1> -->
                    <h1>ArríbaTe</h1>
                </div>
                <div class="linediv"></div>

                <div class="botonbox">
                    <div class="botonbox-in">
                        <div class="boton1">Alquiler<a href="#" onclick="toggleMarkers('alquiler')"></a></div>
                    </div>
                    <div class="botonbox-in">
                        <div class="boton1">Venta<a href="#" onclick="toggleMarkers('venta')"></a></div>
                    </div>
                </div>
            </div>
            <!-- Menu Left FIN -->




            


            <div class="botonbox2">
                <div class="botonbox-in">
                    <div class="boton1">Alquiler<a href="#" onclick="toggleMarkers('alquiler')"></a></div>
                </div>
                <div class="botonbox-in">
                    <div class="boton1">Venta<a href="#" onclick="toggleMarkers('venta')"></a></div>
                </div>
                <div class="cube-boton-filtro-respon"><button id="open-filter-button-respon"></button></div>
            </div>



            <div class="cube-boton-filtro"><button id="open-filter-button">Filtros</button></div>



            <!-- Menu Right -->
            <div class="menumaster-in-right">
                <!-- Alquilar/vender -->

                <!-- <div class="Menu-contacto-redes-respon"></div> -->
                <div class="alquilar-vender-box">
                    <div class="alquilar-vender-box-In">Alquilar/Vender</div>
                </div>
                <!-- Alquilar/vender FIN-->
                <!-- Redes -->
                <div class="redes-box">
                    <div class="redes-box-in">
                        <p>Síguenos:</p>
                        <div class="redes-buttones">
                            <div class="redes-button"></div>
                            <div class="redes-button" style="background-image: url(./img/icons/facebook1.png);"></div>
                            <div class="redes-button" style="background-image: url(./img/icons/x1.png);"></div>
                        </div>
                    </div>
                </div>
                <!-- Redes FIN -->

                <!-- Terminos -->
                <!-- <div class="terminos-condiciones">
                    <button id="openModalTerminosBtn">Términos</button>
                </div> -->
                <!-- Terminos FIN-->


                <!-- Menú new -->
                <div id="openBoxJmBtn" class="menu-all single-menu">
                    <div class="menu-lines">
                        <span class="line line1"></span>
                        <span class="line line2"></span>
                        <span class="line line3"></span>
                    </div>
                </div>






                <!-- Menú new FIN-->
            </div>
            <!-- Menu Right FIN -->

        </div>

        <!-- contacto -->
        <!-- <div class="barcontacto">
        <div class="barcontactobtn">Síguenos:</div>
        <div class="barredesbtn" style="background: #0093ff;"></div>
        <div class="barredesbtn" style="background: #ff6c00;"></div>
        <div class="barredesbtn" style="background: #2d2d2d;"></div>   
    </div> -->
        <!-- contacto FIN-->



        <!-- Barra redes -->
        <!-- <div class="bar-redes">
        <div class="bar-redes-in">
            <p>Redes</p>
            <div class="button-redes"></div>
            <div class="button-redes"></div>
            <div class="button-redes"></div>
        </div>
    </div> -->
        <!-- Barra redes FIN-->


        <!-- MAPA -->
        <div class="mapbox">
            <div id="map" style="background: #aad3df;"></div>
            <!-- Botones capas, location -->
            <button id="changeLayerButton" class="layer-button">
                <img src="./img/capasatelite2.png" alt="Cambiar capa" id="layerIcon">
            </button>

            <button id="locateButton">
                <img src="./img/mi-ubicacion1.png" alt="Mostrar mi ubicación">
            </button>
            <!-- Botones capas, location FIN -->
        </div>
    </div>
    <!-- MAPA Fin-->


    <!-- Modal -->
    <div id="propertyModal" class="modal">
        <div class="modal-content">
            <div class="modal-logo">
                <div class="modal-logo-in">
                    <img src="./img/logo2.png">
                    <p>ARRIBA<span>TE</span></p>
                </div>

            </div>
            <div class="modal-in">
                <!-- <h2>Información de la Propiedad</h2> -->




                <!-- Galeria -->
                <div class="gallery">
                    <div class="main-image">

                        <button class="nav-button-img-p left" id="prevMainImage">&#10094;</button>
                        <img id="currentImage" src="https://sachinchoolur.github.io/lightslider/img/cS-1.jpg"
                            alt="Imagen Principal">
                        <button class="nav-button-img-p right" id="nextMainImage">&#10095;</button>
                    </div>
                    <div class="thumbnails-container">
                        <button class="scroll-button left">&#10094;</button>

                        <div class="thumbnails"></div>

                        <button class="scroll-button right">&#10095;</button>
                    </div>
                </div>

                <div id="fullscreenView">
                    <button class="nav-button left" id="prevImage">&#10094;</button>
                    <div id="fullscreenImageContainer">
                        <img id="fullscreenImage" src="" alt="Imagen en pantalla completa">
                    </div>
                    <button class="nav-button right" id="nextImage">&#10095;</button>
                    <button id="closeFullscreen">Cerrar</button>
                </div>
                <!-- Galeria FIN -->



                <!-- Aquí se inyectará la información de CADA propiedad -->
                <div class="infocompleta">
                    <!-- Modal body -->
                    <div class="modal-body" id="modalPropertyDetails">

                    </div>
                    <!-- Modal body FIN -->



                    <div class="contactos">

                        <p>¿Te interesa esta propiedad?<br>
                            Escríbenos:
                        </p>
                        <a href="#" id="whatsappButton" class="whatsapp-button" onclick="openWhatsApp()"><img
                                src="./img/icons/whatsapp2.svg"><span>WhatsApp</span></a>
                    </div>
                </div>
                <!-- Aquí se inyectará la información de CADA propiedad FIN -->





                

            </div>

            <!-- Información general para todas las propiedades -->
            <div class="modal-end">
                <button id="comoLlegarButton" class="como-llegar-button" onclick="comoLlegarDesdeModal()"><img src="./img/icons/location1.svg">
                    <div><h3>Cómo llegar</h3><span>a esta propiedad</span></div>
                </button>
                <div class="contactos-res">
                    <!-- <p>¿Te interesa esta propiedad?<br>
                        Escríbenos:
                    </p> -->
                    <button id="whatsappButton2" class="whatsapp-button" onclick="openWhatsApp()"><img src="./img/icons/whatsapp2.svg">
                        <div><span>Para más información</span><h3>WhatsApp</h3></div>
                    </button>

                </div>

                <div class="modal-redes">
                    <p>Síguenos en:</p>
                    <img src="./img/icons/instagram1.png">
                    <img src="./img/icons/facebook1.png">
                    <img src="./img/icons/tiktok1.png">
                    <img src="./img/icons/x1.png">
                </div>

            </div>
            <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <!-- Modal FIN -->



        <!-- Modal para imágenes en pantalla completa -->
        <div id="fullscreenModal" class="fullscreen-modal">
            <button class="close-fullscreen" onclick="closeFullscreenModal()">&times;</button>
            <img class="fullscreen-image" id="fullscreenModalImage" src="">
            <button class="nav-button left" id="prevFullscreenImage">&#10094;</button>
            <button class="nav-button right" id="nextFullscreenImage">&#10095;</button>
        </div>
        <!-- Modal para imágenes en pantalla completa FIN -->


    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>




    <!-- // Detectar cambios en el tema del sistema operativo
const colorSchemeQuery = window.matchMedia('(prefers-color-scheme: dark)');

function handleColorSchemeChange(e) {
    const isDarkMode = e.matches;
    const loader = document.querySelector('.loader');

    if (isDarkMode) {
        loader.style.backgroundColor = '#222222';
    } else {
        loader.style.backgroundColor = 'white';
    }
}

// Aplicar estilos iniciales y escuchar cambios
handleColorSchemeChange(colorSchemeQuery);
colorSchemeQuery.addEventListener('change', handleColorSchemeChange); -->





    <!-- Filtros -->
    <div id="price-filter" class="filter">

        <div class="header-filter">
            <h1>Filtros</h1>
            <button id="close-filter-button">X</button>
            <div class="filtro-divisor2"></div>
        </div>


        <div class="body-filter">
            <!-- Filtro de tipo de propiedad -->
            <h2>Tipos de propiedad</h2>
            <div class="filter-buttons">

                <button id="filter-house" class="filter-button active">
                    <img src="./img/casa4.png" alt="Casas">
                    <p>Casas</p>
                </button>
                <button id="filter-building" class="filter-button active">
                    <img src="./img/apartamento2.png" alt="Edificios" style="border-color: #52bae8;">
                    <p>Apartamentos</p>
                </button>
                <button id="filter-land" class="filter-button active">
                    <img src="./img/solar2.png" alt="Solares" style="border-color: #59a739;">
                    <p>Solares</p>
                </button>
            </div>
            <!-- Filtro de tipo de propiedad FIN-->

            <div class="filtro-divisor"></div>

            <!-- Filtro de Precios -->
            <h2>Rango de Precio</h2>

            <div class="price-labels">
                <div class="price-labels-cube">
                    <h6>Mínimo</h6>
                    <input type="text" id="min-price" placeholder="RD$0">
                </div>
                <h6 style="margin-block-start: 25px;color: #777777;">hasta</h6>
                <div class="price-labels-cube">
                    <h6>Máximo</h6>
                    <input type="text" id="max-price" placeholder="RD$0">
                </div>
            </div>

            <div class="range-slider">
                <div class="track"></div>
                <div class="range" id="range-highlight"></div>
                <input type="range" id="min-price-range" min="0" max="30000000" value="0">
                <input type="range" id="max-price-range" min="0" max="30000000" value="30000000">
            </div>

            <!-- Filtro de Precios fin -->

            <div class="filtro-divisor"></div>

            <!-- Filtro de cantidad -->
            <h2>Cantidades</h2>
            <div class="filtro-cantidad-cube">

                <div class="filter-counter">
                    <img src="./img/icons/habitacion1.svg">
                    <h6>Habitaciones</h6>
                    <div class="counter-cube">
                        <button id="decrease-rooms">-</button>
                        <span id="rooms-count">Cualquiera</span>
                        <button id="increase-rooms">+</button>
                    </div>
                </div>

                <div class="filter-counter">
                    <img src="./img/icons/baño2.svg">
                    <h6>Baños</h6>
                    <div class="counter-cube">
                        <button id="decrease-bathrooms">-</button>
                        <span id="bathrooms-count">Cualquiera</span>
                        <button id="increase-bathrooms">+</button>
                    </div>
                </div>

                <div class="filter-counter">
                    <img src="./img/icons/parqueo1.svg">
                    <h6>Parqueos</h6>
                    <div class="counter-cube">
                        <button id="decrease-parking">-</button>
                        <span id="parking-count">Cualquiera</span>
                        <button id="increase-parking">+</button>
                    </div>
                </div>
            </div>
            <!-- Filtro de cantidad FIN -->
        </div>


        <div class="footer-filter">
            <div class="filtro-divisor2">
            </div>
        </div>
        <!-- Filtros FIN -->


    </div>





    <!-- Cuadro BoxJM1 -->
    <div id="boxjm1" class="boxjm1">
        <div class="boxjm1-content">

            <div class="boxjm1-titulo">
                <p>Menu</p>
                <span class="close2">&times;</span>
            </div>
            <div class="boxjm1-body"></div>
            <div class="boxjm1-down">
                <div class="modal-redes">
                    <p>Síguenos en:</p>
                    <img src="./img/icons/instagram1.png">
                    <img src="./img/icons/facebook1.png">
                    <img src="./img/icons/tiktok1.png">
                    <img src="./img/icons/x1.png">
                </div>
            </div>
        </div>
    </div>




    <script>



        // Ocultar la pantalla de carga y mostrar el contenido después de 5 segundos
        setTimeout(function () {
            document.querySelector('.loader').style.display = 'none';
            document.querySelector('.content').style.display = 'block';

        }, 2700);






        // Inicialización del mapa con un maxZoom aumentado
        var map = L.map('map').setView([18.7357, -70.1627], 8);

        // Capas de mapa
        var baseMaps = {
            "Claro": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19
            }).addTo(map),
            "Vista Satelital": L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
                maxZoom: 19
            })
        };

        // Referencia al botón de cambio de capa
        const changeLayerButton = document.getElementById('changeLayerButton');
        let isSatelliteView = false;  // Estado inicial

        changeLayerButton.addEventListener('click', () => {
            if (isSatelliteView) {
                // Cambiar a capa de mapa
                map.removeLayer(baseMaps["Vista Satelital"]);
                baseMaps["Claro"].addTo(map);
                changeLayerButton.querySelector('img').src = './img/capasatelite2.png'; // Cambiar imagen a satélite
                changeLayerButton.querySelector('img').alt = 'Cambiar a Satélite';
            } else {
                // Cambiar a capa satelital
                map.removeLayer(baseMaps["Claro"]);
                baseMaps["Vista Satelital"].addTo(map);
                changeLayerButton.querySelector('img').src = './img/capamapa2.png'; // Cambiar imagen a mapa
                changeLayerButton.querySelector('img').alt = 'Cambiar a Mapa';
            }
            isSatelliteView = !isSatelliteView; // Alternar estado
        });





        // Botón de mi ubicación
        const locateButton = document.getElementById('locateButton');

        // Evento click para centrar el mapa en la ubicación del usuario
        locateButton.addEventListener('click', () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;

                    // Centrar el mapa en la ubicación del usuario
                    map.setView([lat, lng], 17);

                    // Agregar un marcador en la ubicación del usuario sin popup
                    L.marker([lat, lng]).addTo(map);
                }, () => {
                    console.error("No se pudo obtener la ubicación.");
                });
            } else {
                console.error("La geolocalización no es soportada por este navegador.");
            }
        });
        // Botón de mi ubicación FIN






        // Función para formatear números con comas como separadores de miles
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Variables de iconos
        var houseIcon = './img/casa4.png';
        var buildingIcon = './img/apartamento2.png';
        var landIcon = './img/solar2.png';

        // Función para obtener el color del fondo del span según el tipo de propiedad
        function getBackgroundColor(iconUrl) {
            if (iconUrl === houseIcon) {
                return '#e17477'; // Color para casas
            } else if (iconUrl === buildingIcon) {
                return '#52bae8'; // Color para apartamentos
            } else if (iconUrl === landIcon) {
                return '#59a739'; // Color para solares
            } else {
                return 'white'; // Color por defecto
            }
        }


        // Creación de íconos personalizados con precio y color según el tipo de propiedad
        function createIcon(iconUrl, price) {
            var backgroundColor = getBackgroundColor(iconUrl); // Obtener color de fondo
            return L.divIcon({
                html: `<div style="position: relative; display: flex; flex-direction: column; align-items: center;">
                    <img src="${iconUrl}" style="margin-top: -26px;
                    width: 32px; height: 32px; background: #0f1931; border-radius: 31px; border-style: solid; border-color: ${backgroundColor};; border-width: 3px;" />
                    <span style="background: ${backgroundColor}; 

                    font-family: system-ui;
    color: white;
    font-size: 12px;
    font-weight: bold;
                    
                    
                    padding: 2px 4px; border-radius: 3px; margin-top: -8px;">RD$${formatNumber(price)}</span>
                    <div class="price-tip" style="border-top-color: ${backgroundColor};"></div>
                </div>`,
                iconSize: [32, 32],
                iconAnchor: [16, 32],
                popupAnchor: [0, -32]
            });
        }

        // Íconos para referencia
        var roomIcon = './img/icons/habitacion1.svg'; // ícono para habitaciones
        var bathroomIcon = './img/icons/baño1.svg'; // ícono para baños
        var parkingIcon = './img/icons/parqueo1.svg'; // ícono para parqueo
        var areaIcon = './img/icons/area1.svg'; // ícono para área

        // Normalización de ubicaciones
        function normalizeLocation(location) {
            return location.latLng ? { ...location, lat: location.latLng[0], lng: location.latLng[1] } : location;
        }

        // Definición de ubicaciones con información adicional
        var alquileres = [
            { id: 224506, lat: 18.4861, lng: -69.9312, title: 'Casa en Alquiler en Santo Domingo', price: 1200, icon: houseIcon, rooms: 3, bathrooms: 2, parking: 1, area: 120, imageFolder: './img/properties/224506/', imageCount: 5 },
            { id: 224507, latLng: [18.81260613062721, -70.5605276914127], title: 'Edificio Santo Domingo', price: 8000000, icon: buildingIcon, rooms: 15, bathrooms: 12, parking: 8, area: 800, imageFolder: './img/properties/224507/', imageCount: 5 },
            { id: 224508, lat: 19.7570, lng: -70.7667, title: 'Casa en Alquiler en Santiago', price: 1000, icon: houseIcon, rooms: 2, bathrooms: 1, parking: 1, area: 80, imageFolder: './img/properties/224508/', imageCount: 5 }
        ];

        var ventas = [
            {
                id: 224501, lat: 18.533976342086266, lng: -69.84789351675421, title: 'Casa en Venta en Don Oscar', price: 250000, icon: houseIcon, rooms: 3, bathrooms: 2, parking: 1, area: 100,
                caracteristicas: 'El lugar donde puedes disfrutar del estilo de vida de tus sueños. Un entorno excepcional y un estilo de vida inigualable para nuestros residentes. <p>Un conjunto de apartamentos con una amplia gama de comodidades y exclusivas amenidades.',
                imageFolder: './img/properties/224501/', imageCount: 14
            },
            { id: 224502, latLng: [18.465055290827987, -69.81047256391996], title: 'Solar Santo Domingo', price: 5000000, icon: landIcon, rooms: 0, bathrooms: 0, parking: 0, area: 1000, imageFolder: './img/properties/224502/', imageCount: 5 },
            { id: 224503, latLng: [18.515361605411158, -69.79580351613811], title: 'Edificio Santo Domingo', price: 7000000, icon: buildingIcon, rooms: 12, bathrooms: 10, parking: 6, area: 700, imageFolder: './img/properties/224503/', imageCount: 5 },
            { id: 224504, latLng: [18.534530697687792, -69.84886578381361], title: 'Casa calle Santo Domingo', price: 230000, icon: houseIcon, rooms: 4, bathrooms: 3, parking: 2, area: 150, imageFolder: './img/properties/224504/', imageCount: 7 }
        ];

        //Carousel

        // Modificar la función createCarousel para generar imágenes dinámicamente
        function createCarousel(imageFolder, imageCount) {
            let carousel = `<div class="carousel">`;

            // Limitar el bucle a un máximo de 7 imágenes
            const maxImagesToShow = Math.min(imageCount, 7);

            for (let i = 1; i <= maxImagesToShow; i++) {
                const imgSrc = `${imageFolder}${i}.jpg`;
                carousel += `<img src="${imgSrc}" class="${i === 1 ? 'active' : ''}" onload="setCarouselHeight(this)">`;
            }
            carousel += `
        <button class="prev" onclick="changeImage(this, -1)">&#10094;</button>
        <button class="next" onclick="changeImage(this, 1)">&#10095;</button>
        <div class="indicators">
            ${Array.from({ length: maxImagesToShow }, (_, index) => `<span class="indicator ${index === 0 ? 'active' : ''}" onclick="setActiveImage(${index})"></span>`).join('')}
        </div>
    </div>`;
            return carousel;
        }





        function changeImage(button, direction) {
            const carousel = button.parentElement;
            const images = carousel.querySelectorAll('img');
            const indicators = carousel.querySelectorAll('.indicator');
            let currentIndex = Array.from(images).findIndex(img => img.classList.contains('active'));
            images[currentIndex].classList.remove('active');
            indicators[currentIndex].classList.remove('active');
            currentIndex = (currentIndex + direction + images.length) % images.length;
            images[currentIndex].classList.add('active');
            indicators[currentIndex].classList.add('active');
        }

        function setActiveImage(index) {
            const carousels = document.querySelectorAll('.carousel');
            carousels.forEach(carousel => {
                const images = carousel.querySelectorAll('img');
                const indicators = carousel.querySelectorAll('.indicator');
                images.forEach(img => img.classList.remove('active'));
                indicators.forEach(ind => ind.classList.remove('active'));
                images[index].classList.add('active');
                indicators[index].classList.add('active');
            });
        }

        //Carousel FIN



        // PopUP
        function createMarkers(locations, markersArray) {
            locations.forEach(function (location) {
                location = normalizeLocation(location);
                var marker = L.marker([location.lat, location.lng], { icon: createIcon(location.icon, location.price) });

                // Crear el carrusel si hay una carpeta de imágenes disponible
                var carousel = location.imageFolder ? createCarousel(location.imageFolder, location.imageCount) : '';

                marker.bindPopup(
                    `<button id="vermodal" onclick="openModal(${JSON.stringify(location).replace(/"/g, '&quot;')})"></button>
            ${carousel}
            <div class="informacion-basica"> 

             <button id="btncomollegar" onclick="comoLlegar(${location.lat}, ${location.lng})"><img src="./img/icons/location1.svg">Cómo llegar</button>


            <span class="price-text">RD$ ${formatNumber(location.price)}</span><br>
            
            <b>${location.title}</b><br>
            <div class="detalles-basicos"> 
                
            <tittle><img src="${roomIcon}" style="width: 26px; height: 26px;"/> ${location.rooms}
            <img src="${bathroomIcon}" style="width: 26px; height: 26px; margin-left: 10px;"/> ${location.bathrooms}
            <img src="${parkingIcon}" style="width: 26px; height: 26px; margin-left: 10px;"/> ${location.parking}
            <img src="${areaIcon}" style="width: 26px; height: 26px; margin-left: 10px;"/><title="Haz clic para obtener indicaciones de cómo llegar"> ${location.area} m²
            </div>
            </div>`
                ).addTo(map);

                markersArray.push(marker);
            });
        }





        // Función de cómo llegar
        function comoLlegar(lat, lng) {
            var url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`;
            window.open(url, '_blank');
        }




        var alquilerMarkers = [];
        var ventaMarkers = [];

        createMarkers(alquileres, alquilerMarkers);
        createMarkers(ventas, ventaMarkers);

        // Variable para mantener el tipo activo
        var activeType = 'alquiler';

        // Funciones para mostrar/ocultar marcadores
        function toggleMarkers(type) {
            activeType = type; // Actualizar el tipo activo

            var showMarkers = type === 'alquiler' ? alquilerMarkers : ventaMarkers;
            var hideMarkers = type === 'alquiler' ? ventaMarkers : alquilerMarkers;

            showMarkers.forEach(marker => marker.addTo(map));
            hideMarkers.forEach(marker => map.removeLayer(marker));

            filterMarkers(); // Filtrar los marcadores después de cambiar el tipo
        }

        // Inicialmente mostrar solo los alquileres
        toggleMarkers('alquiler');
    </script>

    <script>

        // Variables globales
const modal = document.getElementById('propertyModal');
const modalDetails = document.getElementById('modalPropertyDetails');
const whatsappButton = document.getElementById('whatsappButton');
const mainImage = document.getElementById('currentImage');
const thumbnailsContainer = document.querySelector('.thumbnails');

// Abrir modal con la propiedad
function openModal(property) {
    setupWhatsappButton(property);
    updateModalDetails(property);
    updateGallery(property.imageFolder, property.imageCount);
    history.pushState(null, '', `#id-${property.id}`);
    modal.style.display = "block";
}

// Cerrar modal
function closeModal() {
    modal.style.display = "none";
    history.pushState(null, '', window.location.pathname); // Add this line
}

// Configurar botón de WhatsApp
function setupWhatsappButton(property) {
    const propertyLink = `https://tusitioweb.com/#id-${property.id}`;
    const whatsappMessage = `Me interesa saber más de esta propiedad con el ID ${property.id}: ${propertyLink}`;
    const whatsappUrl = `https://api.whatsapp.com/send?phone=+18299605566&text=${encodeURIComponent(whatsappMessage)}`;
    whatsappButton.href = whatsappUrl;
}

// Actualizar detalles del modal
function updateModalDetails(property) {
    // Extraer latitud y longitud correctamente para el <iframe>
    const lat = property.latLng ? property.latLng[0] : property.lat;
    const lng = property.latLng ? property.latLng[1] : property.lng;

    modalDetails.innerHTML = `
        <p>RD$ ${formatNumber(property.price)}.00</p>
            <div class="share-button-container">
                <button id="shareButton" class="share-button" onclick="shareProperty()"><img src="./img/icons/compartir1.svg"></button>
             </div>
                          
        <h3>ID: ${property.id}</h3>
        <h4>${property.title}</h4>
        <div class="detallesmodalicon"> 
            ${createIconItem(roomIcon, `${property.rooms} Habitaciones`)}
            ${createIconItem(bathroomIcon, `${property.bathrooms} Baños`)}
            ${createIconItem(parkingIcon, `${property.parking} Parqueos`)}
            ${createIconItem(areaIcon, `${property.area} m²`)}
        </div>
        <div class="detallesmodaltext"> 
            <p><strong>Características:</strong> ${property.caracteristicas}</p>
        </div>
        
        <div class="box-modal-googlemap">
            
            <iframe 
                src="https://maps.google.com/maps?q=${lat},${lng}&t=&z=15&ie=UTF8&iwloc=&output=embed" 
                frameborder="0" 
                scrolling="no" 
                style="width: 100%;height: 100%;box-shadow: 0px 0px 0px 2px rgb(0 0 0 / 0%);border-radius: 12px;">
            </iframe>

        </div>
    `;
}


// Crear un ítem de icono para los detalles
function createIconItem(icon, text) {
    return `
        <div class="item">
            <img src="${icon}"><p>${text}</p>
        </div>`;
}

// Actualizar galería
function updateGallery(imageFolder, imageCount) {
    let images = createImageArray(imageFolder, imageCount);
    clearGallery();
    addThumbnails(images);
    if (images.length > 0) {
        mainImage.src = images[0];
        updateActiveThumbnail(0);
    }
    setupGalleryNavigation(images);
    setupFullscreen(images);
}

// Crear array de imágenes
function createImageArray(imageFolder, imageCount) {
    return Array.from({ length: imageCount }, (_, i) => `${imageFolder}${i + 1}.jpg`);
}

// Limpiar galería
function clearGallery() {
    mainImage.src = '';
    thumbnailsContainer.innerHTML = '';
}

// Agregar miniaturas a la galería
function addThumbnails(images) {
    images.forEach((imgSrc, index) => {
        const thumbnail = document.createElement('img');
        thumbnail.src = imgSrc;
        thumbnail.alt = `Thumbnail ${index + 1}`;
        thumbnail.dataset.index = index;
        thumbnail.addEventListener('click', () => {
            mainImage.src = imgSrc;
            updateActiveThumbnail(index);
        });
        thumbnailsContainer.appendChild(thumbnail);
    });
}

// Actualizar miniatura activa
function updateActiveThumbnail(index) {
    document.querySelectorAll('.thumbnails img').forEach((img, i) => {
        img.classList.toggle('active', i === index);
    });
}

// Navegación de la galería
function setupGalleryNavigation(images) {
    let currentIndex = 0;

    document.getElementById('prevMainImage').addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        mainImage.src = images[currentIndex];
        updateActiveThumbnail(currentIndex);
    });

    document.getElementById('nextMainImage').addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % images.length;
        mainImage.src = images[currentIndex];
        updateActiveThumbnail(currentIndex);
    });
}

// Pantalla completa
function setupFullscreen(images) {
    const fullscreenModal = document.getElementById('fullscreenModal');
    const fullscreenImage = document.getElementById('fullscreenModalImage');
    let currentFullscreenIndex = 0;

    function openFullscreenModal(index) {
        currentFullscreenIndex = index;
        fullscreenImage.src = images[currentFullscreenIndex];
        fullscreenModal.style.display = 'block';
    }

    function closeFullscreenModal() {
        fullscreenModal.style.display = 'none';
    }

    document.querySelector('.close-fullscreen').addEventListener('click', closeFullscreenModal);
    document.addEventListener('keydown', (event) => {
        if (event.key === "Escape") {
            closeFullscreenModal();
        }
    });

    document.getElementById('prevFullscreenImage').addEventListener('click', () => {
        currentFullscreenIndex = (currentFullscreenIndex - 1 + images.length) % images.length;
        fullscreenImage.src = images[currentFullscreenIndex];
    });

    document.getElementById('nextFullscreenImage').addEventListener('click', () => {
        currentFullscreenIndex = (currentFullscreenIndex + 1) % images.length;
        fullscreenImage.src = images[currentFullscreenIndex];
    });

    mainImage.addEventListener('click', () => openFullscreenModal(currentFullscreenIndex));
}

// Verificar ID en la URL al cargar
window.addEventListener('load', () => {
    const hash = window.location.hash;
    if (hash.startsWith('#id-')) {
        const propertyId = parseInt(hash.substring('#id-'.length));
        const property = [...alquileres, ...ventas].find(p => p.id === propertyId);
        if (property) {
            openModal(property);
        }
    }
});

// Desplazamiento de thumbnails
window.addEventListener('DOMContentLoaded', () => {
    const scrollLeftButton = document.querySelector('.scroll-button.left');
    const scrollRightButton = document.querySelector('.scroll-button.right');

    scrollLeftButton.addEventListener('click', () => {
        thumbnailsContainer.scrollLeft -= 150;
    });

    scrollRightButton.addEventListener('click', () => {
        thumbnailsContainer.scrollLeft += 150;
    });
});


    </script>

    <script src="./js/scriptfiltros.js"></script>
    <script src="./js/scriptmodal.js"></script>
    <script src="./js/scriptmenu.js"></script>


</body>

</html>